{
    "name": "Flutter Audiobook Player",
    "build": {
        "dockerfile": "../Dockerfile",
        "context": "..",
        "args": {
            "BUILD_TARGET": "web"
        }
    },
    "remoteUser": "root",
    "forwardPorts": [3000, 8000, 8080, 9090],
    "features": {
        "ghcr.io/devcontainers/features/git:1": {},
        "ghcr.io/devcontainers/features/common-utils:2": {}
    },
    "portsAttributes": {
        "3000": {
            "label": "Development Server",
            "onAutoForward": "notify"
        },
        "8000": {
            "label": "Web Server (Testing)",
            "onAutoForward": "notify"
        },
        "8080": {
            "label": "Android Debug Bridge",
            "onAutoForward": "silent"
        },
        "9090": {
            "label": "Flutter DevTools",
            "onAutoForward": "notify"
        }
    },
    "customizations": {
        "vscode": {
            "extensions": [
                "Dart-Code.dart-code",
                "Dart-Code.flutter",
                "ms-vscode-remote.remote-containers",
                "ms-python.python",
                "charliermarsh.ruff",
                "ms-vscode.makefile-tools",
                "zhuangtongfa.Material-theme",
                "GitHub.copilot",
                "ms-vscode.makefile-tools",
                "ms-vscode-remote.vscode-remote-extensionpack"
            ],
            "settings": {
                "dart.lineLength": 100,
                "dart.previewFlutterUiGuides": true,
                "dart.enableSdkFormatter": true,
                "[dart]": {
                    "editor.formatOnSave": true
                },
                "editor.fontSize": 12,
                "editor.fontFamily": "Fira Code, Courier New",
                "editor.formatOnSave": true,
                "editor.rulers": [80, 100],
                "files.watcherExclude": {
                    "**/.dart_tool/**": true,
                    "**/build/**": true,
                    "**/.git/**": true,
                    "**/.pub/**": true,
                    "**/node_modules/**": true,
                    "**/.flutter-plugins": true,
                    "**/.packages": true
                },
                "search.exclude": {
                    "**/.dart_tool": true,
                    "**/build": true,
                    "**/pubspec.lock": true
                },
                "terminal.integrated.defaultProfile.linux": "bash",
                "terminal.integrated.fontSize": 12
            }
        }
    },
    "mounts": [
        "source=${localWorkspaceFolder}/.volumes/ssh,target=/root/.ssh,type=bind,consistency=cached",
        "source=${localWorkspaceFolder}/.volumes/pub-cache,target=/root/.pub-cache,type=bind,consistency=cached",
        "source=${localWorkspaceFolder}/.volumes/flutter-bin,target=/opt/flutter/bin,type=bind,consistency=cached",
        "source=${localWorkspaceFolder}/.volumes/android-sdk,target=/opt/android-sdk-linux,type=bind,consistency=cached",
        "source=${localWorkspaceFolder}/.volumes/gradle,target=/root/.gradle,type=bind,consistency=cached"
    ],
    "runArgs": [
        "--cap-add=SYS_PTRACE",
        "--security-opt=seccomp=unconfined",
        "--memory=4g",
        "--cpus=4"
    ],
    "containerEnv": {
        "FLUTTER_ROOT": "/opt/flutter",
        "ANDROID_HOME": "/opt/android-sdk-linux",
        "ANDROID_SDK_ROOT": "/opt/android-sdk-linux",
        "PUB_CACHE": "/root/.pub-cache",
        "GRADLE_USER_HOME": "/root/.gradle"
    },
    "postCreateCommand": "${containerWorkspaceFolder}/.devcontainer/setup.sh",
    "postStartCommand": "${containerWorkspaceFolder}/.devcontainer/post-start.sh",
    "onCreateCommand": "${containerWorkspaceFolder}/.devcontainer/on-create.sh",
    "workspaceMount": "source=${localWorkspaceFolder},target=/workspace,type=bind,consistency=cached",
    "workspaceFolder": "/workspace",
    "remoteEnv": {
        "PATH": "/opt/flutter/bin:/opt/flutter/bin/cache/dart-sdk/bin:/root/.pub-cache/bin:${containerEnv:PATH}",
        "FLUTTER_ROOT": "/opt/flutter",
        "ANDROID_HOME": "/opt/android-sdk-linux",
        "ANDROID_SDK_ROOT": "/opt/android-sdk-linux",
        "PUB_CACHE": "/root/.pub-cache",
        "GRADLE_USER_HOME": "/root/.gradle"
    },
    "hostRequirements": {
        "cpus": 4,
        "memory": "4gb",
        "storage": "20gb"
    },
    "userEnvProbe": "loginInteractiveShell",
    "init": true,
    "privileged": false,
    "capAdd": ["SYS_PTRACE"],
    "securityOpt": ["seccomp=unconfined"]
}
